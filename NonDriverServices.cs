/***************************************************************************
*                                                                          *
*                      Nestor Lee (15SIS030Y / 1501044)                    *
*                        ICT 4001 - Capstone Project                       *
*                    Cryptocurrency Mining Malware Detector                *
*                    Singapore Institute of Technology (SIT)               * 
*          neslee92@gmail.com / 15SIS030Y@SIT.SingaporeTech.edu.sg         *
*                                                                          *
****************************************************************************/

/*
 * 
 *  Filename:   NonDriverServices.cs 
 *  Purpose:    Class file for the NonDriverServices objects
 *              NonDriverServices objects are used to store the information regarding each user-level services for display in the Service Enumeration tab 
 *              
 */


using System;

namespace WindowsFormsAppHelloworld
{
    internal class NonDriverServices
    {
        private int Index;
        private string ServiceName;
        private string ServiceDescription;
        private string ServiceState;
        private string ServicePID;
        private bool CanServiceStop;
        private bool isServiceSuspicious;
        
        // Getter Functions
        public int getIndex()
        {
            return this.Index;
        }

        public string getServiceName()
        {
            return this.ServiceName;
        }

        public string getServiceDescription()
        {
            return this.ServiceDescription;
        }

        public string getServiceState()
        {
            return this.ServiceState;
        }

        public string getServicePID()
        {
            return this.ServicePID;
        }

        public bool getCanServiceStop()
        {
            return this.CanServiceStop;
        }

        public bool getIsServiceSuspicious()
        {
            return this.isServiceSuspicious;
        }
               
        // NonDriverServices Constructor
        public NonDriverServices(int index, string serviceName, string serviceDescription, string serviceState, string servicePid, bool serviceStoppable)
        {
            this.Index = index;
            this.ServiceName = serviceName;
            this.ServiceDescription = serviceDescription;
            this.ServiceState = serviceState;
            this.ServicePID = servicePid;
            this.CanServiceStop = serviceStoppable;

            // TODO: Determine is service is suspicious
            string[] suspiciousServiceNameList = { "xWinWpdSrv", "SVSHost", "Microsoft Telemetry", "lsass", "Microsoft",
                                                    "system", "Oracleupdate", "CLR", "sysmgt", "gm",
                                                    "WmdnPnSN", "Sougoudl", "Nationaaal", "Natimmonal", "Nationaloll",
                                                    "Mysa", "Mysa1", "Mysa2", "Mysa3", "ok",
                                                    "Oracle Java", "Oracle Java", "Oracle Java Update", "Spooler SubSystem Service",
                                                    "Oracle Products Reporter", "Update service for products", "gm", "ngm"
                                                  };

            foreach (string stringComparedTo in suspiciousServiceNameList)
            {
                if (stringComparedTo.Equals(serviceName, StringComparison.OrdinalIgnoreCase))
                {
                    this.isServiceSuspicious = true;
                    break;
                }
                else
                {
                    // false here
                    this.isServiceSuspicious = false;
                }
            }
            
        }
    }
}