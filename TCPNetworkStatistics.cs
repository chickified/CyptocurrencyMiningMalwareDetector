/***************************************************************************
*                                                                          *
*                      Nestor Lee (15SIS030Y / 1501044)                    *
*                        ICT 4001 - Capstone Project                       *
*                    Cryptocurrency Mining Malware Detector                *
*                    Singapore Institute of Technology (SIT)               * 
*          neslee92@gmail.com / 15SIS030Y@SIT.SingaporeTech.edu.sg         *
*                                                                          *
****************************************************************************/

/*
 * 
 *  Filename:   TCPNetworkStatistics.cs 
 *  Purpose:    Class file for TCPNetworkStatistics objects
 *              TCPNetworkStatistics objects will initialise and store the TCP statistics for the machine the Cryptocurrency Mining Malware Detector is executed on
 *              
 */


using System.Net.NetworkInformation;

namespace WindowsFormsAppHelloworld
{
    internal class TCPNetworkStatistics
    {
        public long CurrentConnections;
        public long CumulativeConections;
        public long InitiatedConnections;
        public long AcceptedConnections;
        public long FailedConnectionAttempts;
        public long ConnectionsReset;

        public TCPNetworkStatistics()
        {
            IPGlobalProperties IPproperties = IPGlobalProperties.GetIPGlobalProperties();
            TcpStatistics tcpNetworkStats = IPproperties.GetTcpIPv4Statistics();

            this.CurrentConnections = tcpNetworkStats.CurrentConnections;
            this.CumulativeConections = tcpNetworkStats.CumulativeConnections;
            this.InitiatedConnections = tcpNetworkStats.ConnectionsInitiated;
            this.AcceptedConnections = tcpNetworkStats.ConnectionsAccepted;
            this.FailedConnectionAttempts = tcpNetworkStats.FailedConnectionAttempts;
            this.ConnectionsReset = tcpNetworkStats.ResetConnections;
        }
    }
}