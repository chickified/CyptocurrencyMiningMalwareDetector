/***************************************************************************
*                                                                          *
*                      Nestor Lee (15SIS030Y / 1501044)                    *
*                        ICT 4001 - Capstone Project                       *
*                    Cryptocurrency Mining Malware Detector                *
*                    Singapore Institute of Technology (SIT)               * 
*          neslee92@gmail.com / 15SIS030Y@SIT.SingaporeTech.edu.sg         *
*                                                                          *
****************************************************************************/

/*
 * 
 *  Filename:   UDPNetworkStatistics.cs 
 *  Purpose:    Class file for UDPNetworkStatistics objects
 *              UDPNetworkStatistics objects will initialise and store the UDP statistics for the machine the Cryptocurrency Mining Malware Detector is executed on
 *              
 */


using System.Net.NetworkInformation;

namespace WindowsFormsAppHelloworld
{
    internal class UDPNetworkStatistics
    {
        public long DatagramsReceived;
        public long DatagramsSent;
        public long IncomingDatagramsDiscarded;
        public long IncomingDatagramsWithErrors;
        public int UDPListeners;

        public UDPNetworkStatistics()
        {
            IPGlobalProperties IPproperties = IPGlobalProperties.GetIPGlobalProperties();
            UdpStatistics udpNetworkStats = IPproperties.GetUdpIPv4Statistics();

            this.DatagramsReceived = udpNetworkStats.DatagramsReceived;
            this.DatagramsSent = udpNetworkStats.DatagramsSent;
            this.IncomingDatagramsDiscarded = udpNetworkStats.IncomingDatagramsDiscarded;
            this.IncomingDatagramsWithErrors = udpNetworkStats.IncomingDatagramsWithErrors;
            this.UDPListeners = udpNetworkStats.UdpListeners;
        }
    }
}